# ==============================================================================
# API Gateway - Environment Configuration
# ==============================================================================
# Copy this file to .env for local development
# ==============================================================================
# NOTE: The API Gateway uses shared configuration from ai-services/shared/config.py
# This file provides gateway-specific environment variables and overrides
# ==============================================================================

# ==============================================================================
# GATEWAY CONFIGURATION
# ==============================================================================

# Gateway host and port
GATEWAY_HOST=0.0.0.0
GATEWAY_PORT=8080

# API version prefix
API_V1_PREFIX=/api/v1

# Debug mode (set to False in production)
DEBUG=True

# Environment: development, staging, production
ENVIRONMENT=development

# ==============================================================================
# SECURITY & AUTHENTICATION
# ==============================================================================

# Secret key for JWT tokens (CRITICAL: Use a secure random key!)
# Generate with: python -c 'import secrets; print(secrets.token_urlsafe(32))'
SECRET_KEY=change-this-to-a-secure-random-key-at-least-32-characters

# JWT Configuration
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# API Key header name (for service-to-service authentication)
API_KEY_HEADER=X-API-Key

# ==============================================================================
# CORS CONFIGURATION
# ==============================================================================

# Allowed origins (comma-separated)
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8000,http://localhost:8080

# Allowed methods (comma-separated)
ALLOWED_METHODS=GET,POST,PUT,PATCH,DELETE,OPTIONS

# Allowed headers
ALLOWED_HEADERS=*

# ==============================================================================
# BACKEND INTEGRATION
# ==============================================================================

# Django backend URL
DJANGO_BACKEND_URL=http://localhost:8000

# Django API key for service-to-service authentication
DJANGO_API_KEY=your-django-api-key-here

# ==============================================================================
# AI MICROSERVICES URLS
# ==============================================================================

# Recommendation Engine
RECOMMENDATION_SERVICE_URL=http://localhost:8001

# Search Engine
SEARCH_SERVICE_URL=http://localhost:8002

# Pricing Engine
PRICING_SERVICE_URL=http://localhost:8003

# Chatbot with RAG
CHATBOT_SERVICE_URL=http://localhost:8004

# Fraud Detection
FRAUD_SERVICE_URL=http://localhost:8005

# Demand Forecasting
FORECAST_SERVICE_URL=http://localhost:8006

# Visual Recognition
VISION_SERVICE_URL=http://localhost:8007

# ==============================================================================
# REDIS CONFIGURATION
# ==============================================================================

# Redis URL for caching and session management
REDIS_URL=redis://localhost:6379/0

# Redis pool settings
REDIS_MAX_CONNECTIONS=50
REDIS_DECODE_RESPONSES=true

# ==============================================================================
# VECTOR DATABASE (QDRANT)
# ==============================================================================

# Qdrant URL for vector similarity search
QDRANT_URL=http://localhost:6333

# Qdrant API key (optional, leave empty if no auth)
QDRANT_API_KEY=

# Qdrant collection names
QDRANT_COLLECTION_PRODUCTS=products
QDRANT_COLLECTION_USERS=users
QDRANT_VECTOR_SIZE=384

# ==============================================================================
# DATABASE (OPTIONAL - for gateway analytics)
# ==============================================================================

# PostgreSQL URL (optional, for storing gateway metrics)
DATABASE_URL=postgresql://ecommerce_ai:ecommerce_ai123@localhost:5433/ecommerce_ai

# Database pool settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10
DB_ECHO=false

# ==============================================================================
# RATE LIMITING
# ==============================================================================

# Enable/disable rate limiting
RATE_LIMIT_ENABLED=true

# Rate limit thresholds
RATE_LIMIT_PER_MINUTE=100
RATE_LIMIT_PER_HOUR=1000
RATE_LIMIT_PER_DAY=10000

# ==============================================================================
# CIRCUIT BREAKER
# ==============================================================================

# Circuit breaker settings for service resilience
CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
CIRCUIT_BREAKER_TIMEOUT_SECONDS=60
CIRCUIT_BREAKER_EXPECTED_EXCEPTION=httpx.RequestError

# ==============================================================================
# LOGGING & MONITORING
# ==============================================================================

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Sentry DSN for error tracking (optional)
SENTRY_DSN=
SENTRY_ENVIRONMENT=development

# Prometheus metrics enabled
ENABLE_METRICS=true

# ==============================================================================
# REQUEST TIMEOUT
# ==============================================================================

# Timeout for proxied requests to AI services (seconds)
SERVICE_REQUEST_TIMEOUT=30

# ==============================================================================
# EXTERNAL API KEYS (OPTIONAL)
# ==============================================================================

# OpenAI API key (if chatbot uses OpenAI)
OPENAI_API_KEY=

# Hugging Face token (for downloading models)
HUGGINGFACE_TOKEN=

# Anthropic API key (if using Claude)
ANTHROPIC_API_KEY=

# ==============================================================================
# FEATURE FLAGS
# ==============================================================================

# Enable/disable specific features
ENABLE_AI_RECOMMENDATIONS=true
ENABLE_FRAUD_DETECTION=true
ENABLE_DYNAMIC_PRICING=true
ENABLE_CHATBOT=true

# ==============================================================================
# NOTES
# ==============================================================================
#
# For Docker deployments:
# - Service URLs should use Docker service names (e.g., http://recommender:8001)
# - Redis URL: redis://redis:6379/0
# - Qdrant URL: http://qdrant:6333
#
# For local development:
# - Use localhost and appropriate ports
# - Ensure all AI services are running before starting the gateway
#
# Security best practices:
# - Never commit actual .env files to git
# - Rotate SECRET_KEY and API keys regularly
# - Use environment-specific .env files (.env.development, .env.production)
# - Store production secrets in secure vaults (AWS Secrets Manager, etc.)
#
